package de.test;

import static org.junit.Assert.*;

import java.io.IOException;
import java.io.InterruptedIOException;
import java.util.Random;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.hbase.HBaseConfiguration;
import org.apache.hadoop.hbase.client.HTable;
import org.apache.hadoop.hbase.client.Put;
import org.apache.hadoop.hbase.client.Result;
import org.apache.hadoop.hbase.client.ResultScanner;
import org.apache.hadoop.hbase.client.RetriesExhaustedWithDetailsException;
import org.apache.hadoop.hbase.client.Scan;
import org.apache.hadoop.hbase.util.Bytes;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;

public class HelloCoprocessorTest {
	HTable testTable;

	@Before
	public void setUp() throws Exception {
		Configuration config = HBaseConfiguration.create();
        config.set("hbase.zookeeper.quorum", "HB");

        testTable = new HTable(config, "test");
	}

	@After
	public void tearDown() throws Exception {
		testTable.close();
	}

	@Test
	public void testPut(){
		Put p = new Put(Bytes.toBytes("row2"));
		p.add(Bytes.toBytes("cf"),Bytes.toBytes("a"),Bytes.toBytes("value2"));
		Exception ex =null;
		try {
			testTable.put(p);
		} catch (RetriesExhaustedWithDetailsException | InterruptedIOException e1) {
			e1.printStackTrace();
			ex = e1;
		}
		
		assert(ex == null);
	}

}
